name: Deployment

on:
  release:
    types:
      - published
jobs:
#  deploy:
#    runs-on: ubuntu-latest
#    steps:
#    - name: Checkout sources
#      uses: actions/checkout@v4
#
#    - name: Setup Gradle
#      uses: gradle/actions/setup-gradle@v3
#
#    - name: Upload in Maven
#      run: |
#        ./gradlew uploadArtifact \
#          -PreleaseVersion="${{ github.event.release.tag_name }}" \
#          -Psigning.keyId="${{ secrets.SIGNING_KEY_ID }}" \
#          -Psigning.password="${{ secrets.SIGNING_PASSWORD }}" \
#          -Psigning.secretKeyRingFile="${{ secrets.SIGNING_SECRET_KEY_RING_FILE }}" \
#          -PtokenBase64="${{ secrets.TOKEN_BASE64 }}"

  update-release:
    runs-on: ubuntu-latest
    steps:
      - name: Update release description
        run: |
          existingDescription=$(gh release view ${{ github.event.release.tag_name }} --repo ${{ github.repository }} --json body -q '.body')

          newDescription='[Maven Repository](https://central.sonatype.com/artifact/io.github.damirdenis-tudor/${{ github.event.repository.name }}/${{ github.event.release.tag_name }})'

          updatedDescription="${existingDescription}\n${newDescription}"

          gh release edit ${{ github.event.release.tag_name }} --repo ${{ github.repository }} --body "$updatedDescription"